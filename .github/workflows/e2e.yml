name: E2E Tests (Docker)

# E2E tests are currently disabled as they require:
# 1. Proper LLM API keys configured
# 2. Full Docker environment with all services
# 3. Frontend build and Playwright setup
#
# To re-enable:
# 1. Set up required secrets (LLM API keys)
# 2. Uncomment the job below
# 3. Configure docker-compose.yml with proper environment variables

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

jobs:
  e2e-placeholder:
    name: E2E Tests (Skipped)
    runs-on: ubuntu-latest
    steps:
      - name: E2E tests skipped
        run: |
          echo "E2E tests are currently disabled"
          echo "Main CI/CD pipeline runs unit tests"
          echo "To run E2E tests locally: make dev && cd web && pnpm run test:e2e"

  # Uncomment below when E2E infrastructure is ready
  # e2e:
  #   runs-on: ubuntu-latest
  #
  #   steps:
  #     - name: Checkout
  #       uses: actions/checkout@v4
  #
  #     - name: Set up Docker Buildx
  #       uses: docker/setup-buildx-action@v3
  #
  #     - name: Build API image
  #       uses: docker/build-push-action@v5
  #       with:
  #         context: .
  #         file: ./Dockerfile
  #         push: false
  #         tags: memstack-api:ci
  #         load: true
  #         cache-from: type=gha
  #         cache-to: type=gha,mode=max
  #
  #     - name: Start stack
  #       run: |
  #         docker compose up -d neo4j postgres redis
  #         # Wait a bit for DBs to initialize
  #         sleep 10
  #         docker compose up -d api
  #         # Wait for API health
  #         for i in {1..40}; do
  #           curl -sf http://localhost:8000/health && break
  #           sleep 3
  #         done
  #         curl -sf http://localhost:8000/health
  #
  #     - name: Set up Node
  #       uses: actions/setup-node@v4
  #       with:
  #         node-version: '20'
  #
  #     - name: Install pnpm
  #       run: npm i -g pnpm
  #
  #     - name: Install web deps
  #       working-directory: web
  #       run: pnpm install
  #
  #     - name: Install Playwright browsers
  #       working-directory: web
  #       run: pnpm exec playwright install --with-deps
  #
  #     - name: Run E2E tests
  #       working-directory: web
  #       env:
  #         CI: true
  #         VITE_API_URL: http://localhost:8000
  #       run: pnpm run test:e2e
  #
  #     - name: Upload Playwright report
  #       if: always()
  #       uses: actions/upload-artifact@v4
  #       with:
  #         name: playwright-report
  #         path: web/playwright-report
  #         if-no-files-found: ignore
